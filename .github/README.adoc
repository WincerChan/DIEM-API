= DIEM API
WincerChan

image:https://img.shields.io/circleci/project/github/WincerChan/Meme-generator.svg?style=flat-square[CircleCI, link=https://circleci.com/gh/WincerChan/Hitokoto/tree/master]
image:https://img.shields.io/badge/License-GPL%20v3-blue.svg?style=flat-square[License: GPL v3, https://www.gnu.org/licenses/gpl-3.0]
image:https://img.shields.io/github/languages/code-size/WincerChan/Hitokoto.svg?style=flat-square[GitHub code size in bytes]


目前系统有如下 API：

. 一言（Hitokoto）
. 网易云音乐（Cloudmusic）
. Google 分析（Google Analytics）（这条并没有什么卵用
. 博客搜索的 API（仅作流量转发和字段验证）

有关这些 API 的具体信息请移步至 https://api.itswincer.com[API 的文档]（文档包含展示及测试模块，GitHub 无法展示）。

== 部署

依赖如下：

. Elixir (限流模块使用，二者使用 Unix Domain Socket 通信，可以通过配置文件 rate-limit 的 enable 字段禁用掉)
. Rust（博客的搜索 API，基于 Tantivy）

部署前需要使用

=== 普通部署

clone 本仓库并在 `diem.toml` 修改相关的信息。

[source,sh]
----
go build -o server # <1>
env CONFIG=./ ./server # <2>
env GIN_MODE=release CONFIG=./ ./server # <3>
----
<1> 编译成二进制
<2> 开发环境
<3> 生产环境（即设置环境变量 GIN_MODE 为 release）

其中生产环境不会在终端打印日志，而是会把日志都记录在 _log 文件夹内。

=== 容器版部署（推荐）

由于引入了 Unix Domain Socket，所以已经不再适合 K8s 部署了，仍有这方面需求的可以切换到 HTTP Branch，但我不会再更新相关的配置了。

== 致谢

image:jetbrains-variant-4.png[jetbrains, link=https://www.jetbrains.com/?from=DIEM-API,width=160,height=90]
